<div class="container py-5">
  <% if notice %>
    <div class="alert alert-success alert-dismissible fade show" role="alert">
      <%= notice %>
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
  <% end %>

  <div class="card shadow-sm">
    <div class="card-header bg-primary text-white">
      <div class="d-flex justify-content-between align-items-center">
        <h4 class="mb-0">
          <i class="bi bi-box-seam me-2"></i>Products
        </h4>
        <div>
          <%= link_to new_product_path, class: 'btn btn-light btn-sm' do %>
            <i class="bi bi-plus-circle me-1"></i> New Product
          <% end %>
        </div>
      </div>
    </div>
    <div class="card-body">
      <div class="mb-3">
        <%= form_with url: sync_from_sheet_products_path, method: :post, local: true, class: 'd-flex gap-2' do |f| %>
          <%= f.text_field :sheet_id, placeholder: 'Spreadsheet ID', class: 'form-control', style: 'max-width:300px;' %>
          <%= f.submit 'Sync from Google Sheet', class: 'btn btn-primary' %>
        <% end %>
      </div>

      <% if @products.any? %>
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead class="table-light">
              <tr>
                <th style="width: 60px;">#</th>
                <th>Name</th>
                <th>Category</th>
                <th class="text-end" style="width: 120px;">Price</th>
                <th class="text-center" style="width: 100px;">Stock</th>
                <th class="text-end" style="width: 200px;">Actions</th>
              </tr>
            </thead>
            <tbody>
              <% @products.each do |product| %>
                <tr>
                  <td>
                    <span class="badge bg-secondary">#<%= product.id %></span>
                  </td>
                  <td>
                    <strong><%= product.name %></strong>
                  </td>
                  <td>
                    <% if product.category.present? %>
                      <span class="badge bg-info text-dark"><%= product.category %></span>
                    <% else %>
                      <span class="text-muted">N/A</span>
                    <% end %>
                  </td>
                  <td class="text-end">
                    <strong class="text-success"><%= number_to_currency(product.price || 0, unit: "â‚º") %></strong>
                  </td>
                  <td class="text-center">
                    <% if product.stock.present? %>
                      <span class="badge <%= product.stock > 0 ? 'bg-success' : 'bg-warning' %>">
                        <%= product.stock %>
                      </span>
                    <% else %>
                      <span class="text-muted">N/A</span>
                    <% end %>
                  </td>
                  <td class="text-end">
                    <div class="d-flex gap-1 justify-content-end">
                      <%= link_to product_path(product), class: 'btn btn-sm btn-info text-white', title: 'View Details' do %>
                        <i class="bi bi-eye"></i>
                      <% end %>
                      <%= link_to edit_product_path(product), class: 'btn btn-sm btn-warning', title: 'Edit' do %>
                        <i class="bi bi-pencil"></i>
                      <% end %>
                      <%= button_to product_path(product), 
                          method: :delete, 
                          class: 'btn btn-sm btn-danger',
                          title: 'Delete' do %>
                        <i class="bi bi-trash"></i>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        </div>
      <% else %>
        <div class="text-center py-5">
          <i class="bi bi-inbox" style="font-size: 3rem; color: #ccc;"></i>
          <p class="text-muted mt-3">No products found.</p>
        </div>
      <% end %>
    </div>
  </div>
</div>
